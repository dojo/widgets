{"version":3,"file":"Base.js","sourceRoot":"","sources":["../../../../../src/widget-core/meta/Base.ts"],"names":[],"mappings":";;;;;;;;;;;;IAAA,sDAAqD;IACrD,sCAAiC;IAGjC;QAA0B,gCAAW;QAQpC,cAAY,UAAgC;YAA5C,YACC,iBAAO,SAOP;YAZO,wBAAkB,GAAG,IAAI,aAAG,EAAmB,CAAC;YAOvD,KAAI,CAAC,WAAW,GAAG,UAAU,CAAC,UAAU,CAAC;YACzC,KAAI,CAAC,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;YAC1C,EAAE,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;gBACrB,KAAI,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC;YAC9B,CAAC;;QACF,CAAC;QAEM,kBAAG,GAAV,UAAW,GAAoB;YAC9B,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAClC,CAAC;QAES,sBAAO,GAAjB,UAAkB,GAAoB;YAAtC,iBAgBC;YAfA,IAAM,SAAS,GAAG,KAAG,GAAK,CAAC;YAC3B,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAE7C,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBACtD,IAAM,QAAM,GAAG,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,SAAS,EAAE;oBAC7C,QAAM,CAAC,OAAO,EAAE,CAAC;oBACjB,KAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;oBAC1C,KAAI,CAAC,UAAU,EAAE,CAAC;gBACnB,CAAC,CAAC,CAAC;gBAEH,IAAI,CAAC,GAAG,CAAC,QAAM,CAAC,CAAC;gBACjB,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YACxC,CAAC;YAED,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;QAES,yBAAU,GAApB;YACC,IAAI,CAAC,WAAW,EAAE,CAAC;QACpB,CAAC;QAEM,0BAAW,GAAlB;YACC,yBAAyB;QAC1B,CAAC;QACF,WAAC;IAAD,CAAC,AA/CD,CAA0B,yBAAW,GA+CpC;IA/CY,oBAAI;IAiDjB,kBAAe,IAAI,CAAC","sourcesContent":["import { Destroyable } from '../../core/Destroyable';\nimport Set from '../../shim/Set';\nimport { WidgetMetaBase, WidgetMetaProperties, NodeHandlerInterface, WidgetBaseInterface } from '../interfaces';\n\nexport class Base extends Destroyable implements WidgetMetaBase {\n\tprivate _invalidate: () => void;\n\tprotected nodeHandler: NodeHandlerInterface;\n\n\tprivate _requestedNodeKeys = new Set<string | number>();\n\n\tprotected _bind: WidgetBaseInterface | undefined;\n\n\tconstructor(properties: WidgetMetaProperties) {\n\t\tsuper();\n\n\t\tthis._invalidate = properties.invalidate;\n\t\tthis.nodeHandler = properties.nodeHandler;\n\t\tif (properties.bind) {\n\t\t\tthis._bind = properties.bind;\n\t\t}\n\t}\n\n\tpublic has(key: string | number): boolean {\n\t\treturn this.nodeHandler.has(key);\n\t}\n\n\tprotected getNode(key: string | number): Element | undefined {\n\t\tconst stringKey = `${key}`;\n\t\tconst node = this.nodeHandler.get(stringKey);\n\n\t\tif (!node && !this._requestedNodeKeys.has(stringKey)) {\n\t\t\tconst handle = this.nodeHandler.on(stringKey, () => {\n\t\t\t\thandle.destroy();\n\t\t\t\tthis._requestedNodeKeys.delete(stringKey);\n\t\t\t\tthis.invalidate();\n\t\t\t});\n\n\t\t\tthis.own(handle);\n\t\t\tthis._requestedNodeKeys.add(stringKey);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tprotected invalidate(): void {\n\t\tthis._invalidate();\n\t}\n\n\tpublic afterRender(): void {\n\t\t// Do nothing by default.\n\t}\n}\n\nexport default Base;\n"]}