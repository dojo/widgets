{"version":3,"file":"Resize.js","sourceRoot":"","sources":["Resize.ts"],"names":[],"mappings":";;;;;;;;;;;;IAAA,+BAA8B;IAC9B,sCAAiC;IAoCjC;QAA4B,kCAAI;QAAhC;YAAA,qEA6CC;YA5CQ,cAAQ,GAAG,IAAI,aAAG,EAAuC,CAAC;;QA4CnE,CAAC;QA1CO,oBAAG,GAAV,UACC,GAAoB,EACpB,UAAqC;YAFtC,iBAyCC;YAvCA,2BAAA,EAAA,aAAa,EAAwB;YAErC,IAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAE/B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBACX,IAAM,eAAe,GAAuB,EAAE,CAAC;gBAC/C,GAAG,CAAC,CAAC,IAAI,WAAW,IAAI,UAAU,CAAC,CAAC,CAAC;oBACpC,eAAe,CAAC,WAAW,CAAC,GAAG,KAAK,CAAC;gBACtC,CAAC;gBACD,MAAM,CAAC,eAAwC,CAAC;YACjD,CAAC;YAED,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC7B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;gBAC3B,IAAM,cAAc,GAAG,IAAI,cAAc,CAAC,UAAC,EAAO;wBAAP,0BAAO,EAAN,aAAK;oBAChD,IAAI,gBAAgB,GAAG,KAAK,CAAC;oBAC7B,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;wBAC5B,IAAA,+BAAW,CAAW;wBAC9B,IAAM,eAAe,GAAG,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;wBAC/C,IAAI,kBAAkB,GAAuB,EAAE,CAAC;wBAEhD,GAAG,CAAC,CAAC,IAAI,WAAW,IAAI,UAAU,CAAC,CAAC,CAAC;4BACpC,IAAM,QAAQ,GAAG,UAAU,CAAC,WAAW,CAAC,CAAC,WAAW,CAAC,CAAC;4BACtD,kBAAkB,CAAC,WAAW,CAAC,GAAG,QAAQ,CAAC;4BAC3C,EAAE,CAAC,CAAC,CAAC,gBAAgB,IAAI,QAAQ,KAAK,eAAgB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gCACrE,gBAAgB,GAAG,IAAI,CAAC;4BACzB,CAAC;wBACF,CAAC;wBAED,KAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;oBAC5C,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,gBAAgB,GAAG,IAAI,CAAC;oBACzB,CAAC;oBACD,gBAAgB,IAAI,KAAI,CAAC,UAAU,EAAE,CAAC;gBACvC,CAAC,CAAC,CAAC;gBACH,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAC9B,CAAC;YAED,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAA0B,CAAC;QACxD,CAAC;QACF,aAAC;IAAD,CAAC,AA7CD,CAA4B,WAAI,GA6C/B;IA7CY,wBAAM;IA+CnB,kBAAe,MAAM,CAAC","sourcesContent":["import { Base } from './Base';\nimport Map from '../../shim/Map';\n\ninterface Observer {\n\tobserve(node: HTMLElement): void;\n}\n\ndeclare const ResizeObserver: {\n\tprototype: Observer;\n\tnew (callback: (entries: ResizeObserverEntry[]) => any): any;\n};\n\ninterface ResizeObserverEntry {\n\tcontentRect: ContentRect;\n}\n\nexport interface ContentRect {\n\treadonly bottom: number;\n\treadonly height: number;\n\treadonly left: number;\n\treadonly right: number;\n\treadonly top: number;\n\treadonly width: number;\n\treadonly x: number;\n\treadonly y: number;\n}\n\nexport interface PredicateFunction {\n\t(contentRect: ContentRect): boolean;\n}\n\nexport interface PredicateFunctions {\n\t[id: string]: PredicateFunction;\n}\n\nexport type PredicateResponses<T = PredicateFunctions> = { [id in keyof T]: boolean };\n\nexport class Resize extends Base {\n\tprivate _details = new Map<string | number, PredicateResponses>();\n\n\tpublic get<T extends PredicateFunctions>(\n\t\tkey: string | number,\n\t\tpredicates = {} as PredicateFunctions\n\t): PredicateResponses<T> {\n\t\tconst node = this.getNode(key);\n\n\t\tif (!node) {\n\t\t\tconst defaultResponse: PredicateResponses = {};\n\t\t\tfor (let predicateId in predicates) {\n\t\t\t\tdefaultResponse[predicateId] = false;\n\t\t\t}\n\t\t\treturn defaultResponse as PredicateResponses<T>;\n\t\t}\n\n\t\tif (!this._details.has(key)) {\n\t\t\tthis._details.set(key, {});\n\t\t\tconst resizeObserver = new ResizeObserver(([entry]) => {\n\t\t\t\tlet predicateChanged = false;\n\t\t\t\tif (Object.keys(predicates).length) {\n\t\t\t\t\tconst { contentRect } = entry;\n\t\t\t\t\tconst previousDetails = this._details.get(key);\n\t\t\t\t\tlet predicateResponses: PredicateResponses = {};\n\n\t\t\t\t\tfor (let predicateId in predicates) {\n\t\t\t\t\t\tconst response = predicates[predicateId](contentRect);\n\t\t\t\t\t\tpredicateResponses[predicateId] = response;\n\t\t\t\t\t\tif (!predicateChanged && response !== previousDetails![predicateId]) {\n\t\t\t\t\t\t\tpredicateChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._details.set(key, predicateResponses);\n\t\t\t\t} else {\n\t\t\t\t\tpredicateChanged = true;\n\t\t\t\t}\n\t\t\t\tpredicateChanged && this.invalidate();\n\t\t\t});\n\t\t\tresizeObserver.observe(node);\n\t\t}\n\n\t\treturn this._details.get(key) as PredicateResponses<T>;\n\t}\n}\n\nexport default Resize;\n"]}