{"version":3,"file":"diff.mjs","sourceRoot":"","sources":["../../../../src/widget-core/diff.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,gBAAgB,EAAE,MAAM,YAAY,CAAC;AAE9C,yBAAyB,KAAU;IAClC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,iBAAiB,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;AAC5F,CAAC;AAED,MAAM,iBAAiB,gBAAqB,EAAE,WAAgB;IAC7D,MAAM,CAAC;QACN,OAAO,EAAE,IAAI;QACb,KAAK,EAAE,WAAW;KAClB,CAAC;AACH,CAAC;AAED,MAAM,iBAAiB,gBAAqB,EAAE,WAAgB;IAC7D,MAAM,CAAC;QACN,OAAO,EAAE,KAAK;QACd,KAAK,EAAE,WAAW;KAClB,CAAC;AACH,CAAC;AAED,MAAM,oBAAoB,gBAAqB,EAAE,WAAgB;IAChE,MAAM,CAAC;QACN,OAAO,EAAE,gBAAgB,KAAK,WAAW;QACzC,KAAK,EAAE,WAAW;KAClB,CAAC;AACH,CAAC;AAED,MAAM,kBAAkB,gBAAqB,EAAE,WAAgB;IAC9D,IAAI,OAAO,GAAG,KAAK,CAAC;IAEpB,MAAM,gBAAgB,GAAG,gBAAgB,IAAI,eAAe,CAAC,gBAAgB,CAAC,CAAC;IAC/E,MAAM,gBAAgB,GAAG,WAAW,IAAI,eAAe,CAAC,WAAW,CAAC,CAAC;IAErE,EAAE,CAAC,CAAC,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAC5C,MAAM,CAAC;YACN,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,WAAW;SAClB,CAAC;IACH,CAAC;IAED,MAAM,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;IACnD,MAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAEzC,EAAE,CAAC,CAAC,YAAY,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;QAC5C,OAAO,GAAG,IAAI,CAAC;IAChB,CAAC;IAAC,IAAI,CAAC,CAAC;QACP,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE;YAC9B,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,gBAAgB,CAAC,GAAG,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;IACJ,CAAC;IACD,MAAM,CAAC;QACN,OAAO;QACP,KAAK,EAAE,WAAW;KAClB,CAAC;AACH,CAAC;AAED,MAAM,eAAe,gBAAqB,EAAE,WAAgB;IAC3D,IAAI,MAAM,CAAC;IACX,EAAE,CAAC,CAAC,OAAO,WAAW,KAAK,UAAU,CAAC,CAAC,CAAC;QACvC,EAAE,CAAC,CAAC,WAAW,CAAC,KAAK,KAAK,gBAAgB,CAAC,CAAC,CAAC;YAC5C,MAAM,GAAG,SAAS,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;QACnD,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,MAAM,GAAG,MAAM,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;QAChD,CAAC;IACF,CAAC;IAAC,IAAI,CAAC,EAAE,CAAC,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;QACzC,MAAM,GAAG,OAAO,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;IACjD,CAAC;IAAC,IAAI,CAAC,CAAC;QACP,MAAM,GAAG,SAAS,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;IACnD,CAAC;IACD,MAAM,CAAC,MAAM,CAAC;AACf,CAAC","sourcesContent":["import { PropertyChangeRecord } from './interfaces';\nimport { WIDGET_BASE_TYPE } from './Registry';\n\nfunction isObjectOrArray(value: any): boolean {\n\treturn Object.prototype.toString.call(value) === '[object Object]' || Array.isArray(value);\n}\n\nexport function always(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: true,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function ignore(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: false,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function reference(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: previousProperty !== newProperty,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function shallow(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\tlet changed = false;\n\n\tconst validOldProperty = previousProperty && isObjectOrArray(previousProperty);\n\tconst validNewProperty = newProperty && isObjectOrArray(newProperty);\n\n\tif (!validOldProperty || !validNewProperty) {\n\t\treturn {\n\t\t\tchanged: true,\n\t\t\tvalue: newProperty\n\t\t};\n\t}\n\n\tconst previousKeys = Object.keys(previousProperty);\n\tconst newKeys = Object.keys(newProperty);\n\n\tif (previousKeys.length !== newKeys.length) {\n\t\tchanged = true;\n\t} else {\n\t\tchanged = newKeys.some((key) => {\n\t\t\treturn newProperty[key] !== previousProperty[key];\n\t\t});\n\t}\n\treturn {\n\t\tchanged,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function auto(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\tlet result;\n\tif (typeof newProperty === 'function') {\n\t\tif (newProperty._type === WIDGET_BASE_TYPE) {\n\t\t\tresult = reference(previousProperty, newProperty);\n\t\t} else {\n\t\t\tresult = ignore(previousProperty, newProperty);\n\t\t}\n\t} else if (isObjectOrArray(newProperty)) {\n\t\tresult = shallow(previousProperty, newProperty);\n\t} else {\n\t\tresult = reference(previousProperty, newProperty);\n\t}\n\treturn result;\n}\n"]}