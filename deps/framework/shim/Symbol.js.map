{"version":3,"file":"Symbol.js","sourceRoot":"","sources":["Symbol.ts"],"names":[],"mappings":"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","sourcesContent":["import has from './support/has';\nimport global from './global';\nimport { getValueDescriptor } from './support/util';\n\ndeclare global {\n\tinterface SymbolConstructor {\n\t\tobservable: symbol;\n\t}\n}\n\nexport let Symbol: SymbolConstructor = global.Symbol;\n\nif (!has('es6-symbol')) {\n\t/**\n\t * Throws if the value is not a symbol, used internally within the Shim\n\t * @param  {any}    value The value to check\n\t * @return {symbol}       Returns the symbol or throws\n\t */\n\tconst validateSymbol = function validateSymbol(value: any): symbol {\n\t\tif (!isSymbol(value)) {\n\t\t\tthrow new TypeError(value + ' is not a symbol');\n\t\t}\n\t\treturn value;\n\t};\n\n\tconst defineProperties = Object.defineProperties;\n\tconst defineProperty: (\n\t\to: any,\n\t\tp: string | symbol,\n\t\tattributes: PropertyDescriptor & ThisType<any>\n\t) => any = Object.defineProperty as any;\n\tconst create = Object.create;\n\n\tconst objPrototype = Object.prototype;\n\n\tconst globalSymbols: { [key: string]: symbol } = {};\n\n\tconst getSymbolName = (function() {\n\t\tconst created = create(null);\n\t\treturn function(desc: string | number): string {\n\t\t\tlet postfix = 0;\n\t\t\tlet name: string;\n\t\t\twhile (created[String(desc) + (postfix || '')]) {\n\t\t\t\t++postfix;\n\t\t\t}\n\t\t\tdesc += String(postfix || '');\n\t\t\tcreated[desc] = true;\n\t\t\tname = '@@' + desc;\n\n\t\t\t// FIXME: Temporary guard until the duplicate execution when testing can be\n\t\t\t// pinned down.\n\t\t\tif (!Object.getOwnPropertyDescriptor(objPrototype, name)) {\n\t\t\t\tdefineProperty(objPrototype, name, {\n\t\t\t\t\tset: function(this: Symbol, value: any) {\n\t\t\t\t\t\tdefineProperty(this, name, getValueDescriptor(value));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn name;\n\t\t};\n\t})();\n\n\tconst InternalSymbol = function Symbol(this: any, description?: string | number): symbol {\n\t\tif (this instanceof InternalSymbol) {\n\t\t\tthrow new TypeError('TypeError: Symbol is not a constructor');\n\t\t}\n\t\treturn Symbol(description);\n\t};\n\n\tSymbol = global.Symbol = function Symbol(this: Symbol, description?: string | number): symbol {\n\t\tif (this instanceof Symbol) {\n\t\t\tthrow new TypeError('TypeError: Symbol is not a constructor');\n\t\t}\n\t\tconst sym = Object.create(InternalSymbol.prototype);\n\t\tdescription = description === undefined ? '' : String(description);\n\t\treturn defineProperties(sym, {\n\t\t\t__description__: getValueDescriptor(description),\n\t\t\t__name__: getValueDescriptor(getSymbolName(description))\n\t\t});\n\t} as SymbolConstructor;\n\n\t/* Decorate the Symbol function with the appropriate properties */\n\tdefineProperty(\n\t\tSymbol,\n\t\t'for',\n\t\tgetValueDescriptor(function(key: string): symbol {\n\t\t\tif (globalSymbols[key]) {\n\t\t\t\treturn globalSymbols[key];\n\t\t\t}\n\t\t\treturn (globalSymbols[key] = Symbol(String(key)));\n\t\t})\n\t);\n\tdefineProperties(Symbol, {\n\t\tkeyFor: getValueDescriptor(function(sym: symbol): string | undefined {\n\t\t\tlet key: string;\n\t\t\tvalidateSymbol(sym);\n\t\t\tfor (key in globalSymbols) {\n\t\t\t\tif (globalSymbols[key] === sym) {\n\t\t\t\t\treturn key;\n\t\t\t\t}\n\t\t\t}\n\t\t}),\n\t\thasInstance: getValueDescriptor(Symbol.for('hasInstance'), false, false),\n\t\tisConcatSpreadable: getValueDescriptor(Symbol.for('isConcatSpreadable'), false, false),\n\t\titerator: getValueDescriptor(Symbol.for('iterator'), false, false),\n\t\tmatch: getValueDescriptor(Symbol.for('match'), false, false),\n\t\tobservable: getValueDescriptor(Symbol.for('observable'), false, false),\n\t\treplace: getValueDescriptor(Symbol.for('replace'), false, false),\n\t\tsearch: getValueDescriptor(Symbol.for('search'), false, false),\n\t\tspecies: getValueDescriptor(Symbol.for('species'), false, false),\n\t\tsplit: getValueDescriptor(Symbol.for('split'), false, false),\n\t\ttoPrimitive: getValueDescriptor(Symbol.for('toPrimitive'), false, false),\n\t\ttoStringTag: getValueDescriptor(Symbol.for('toStringTag'), false, false),\n\t\tunscopables: getValueDescriptor(Symbol.for('unscopables'), false, false)\n\t});\n\n\t/* Decorate the InternalSymbol object */\n\tdefineProperties(InternalSymbol.prototype, {\n\t\tconstructor: getValueDescriptor(Symbol),\n\t\ttoString: getValueDescriptor(\n\t\t\tfunction(this: { __name__: string }) {\n\t\t\t\treturn this.__name__;\n\t\t\t},\n\t\t\tfalse,\n\t\t\tfalse\n\t\t)\n\t});\n\n\t/* Decorate the Symbol.prototype */\n\tdefineProperties(Symbol.prototype, {\n\t\ttoString: getValueDescriptor(function(this: Symbol) {\n\t\t\treturn 'Symbol (' + (<any>validateSymbol(this)).__description__ + ')';\n\t\t}),\n\t\tvalueOf: getValueDescriptor(function(this: Symbol) {\n\t\t\treturn validateSymbol(this);\n\t\t})\n\t});\n\n\tdefineProperty(\n\t\tSymbol.prototype,\n\t\tSymbol.toPrimitive,\n\t\tgetValueDescriptor(function(this: Symbol) {\n\t\t\treturn validateSymbol(this);\n\t\t})\n\t);\n\tdefineProperty(Symbol.prototype, Symbol.toStringTag, getValueDescriptor('Symbol', false, false, true));\n\n\tdefineProperty(\n\t\tInternalSymbol.prototype,\n\t\tSymbol.toPrimitive,\n\t\tgetValueDescriptor((<any>Symbol).prototype[Symbol.toPrimitive], false, false, true)\n\t);\n\tdefineProperty(\n\t\tInternalSymbol.prototype,\n\t\tSymbol.toStringTag,\n\t\tgetValueDescriptor((<any>Symbol).prototype[Symbol.toStringTag], false, false, true)\n\t);\n}\n\n/**\n * A custom guard function that determines if an object is a symbol or not\n * @param  {any}       value The value to check to see if it is a symbol or not\n * @return {is symbol}       Returns true if a symbol or not (and narrows the type guard)\n */\nexport function isSymbol(value: any): value is symbol {\n\treturn (value && (typeof value === 'symbol' || value['@@toStringTag'] === 'Symbol')) || false;\n}\n\n/**\n * Fill any missing well known symbols if the native Symbol is missing them\n */\n[\n\t'hasInstance',\n\t'isConcatSpreadable',\n\t'iterator',\n\t'species',\n\t'replace',\n\t'search',\n\t'split',\n\t'match',\n\t'toPrimitive',\n\t'toStringTag',\n\t'unscopables',\n\t'observable'\n].forEach((wellKnown) => {\n\tif (!(Symbol as any)[wellKnown]) {\n\t\tObject.defineProperty(Symbol, wellKnown, getValueDescriptor(Symbol.for(wellKnown), false, false));\n\t}\n});\n\nexport default Symbol;\n"]}