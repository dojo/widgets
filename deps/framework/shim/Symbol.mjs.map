{"version":3,"file":"Symbol.mjs","sourceRoot":"","sources":["../../../../src/shim/Symbol.ts"],"names":[],"mappings":"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","sourcesContent":["import has from './support/has';\nimport global from './global';\nimport { getValueDescriptor } from './support/util';\n\ndeclare global {\n\tinterface SymbolConstructor {\n\t\tobservable: symbol;\n\t}\n}\n\nexport let Symbol: SymbolConstructor = global.Symbol;\n\nif (!has('es6-symbol')) {\n\t/**\n\t * Throws if the value is not a symbol, used internally within the Shim\n\t * @param  {any}    value The value to check\n\t * @return {symbol}       Returns the symbol or throws\n\t */\n\tconst validateSymbol = function validateSymbol(value: any): symbol {\n\t\tif (!isSymbol(value)) {\n\t\t\tthrow new TypeError(value + ' is not a symbol');\n\t\t}\n\t\treturn value;\n\t};\n\n\tconst defineProperties = Object.defineProperties;\n\tconst defineProperty: (\n\t\to: any,\n\t\tp: string | symbol,\n\t\tattributes: PropertyDescriptor & ThisType<any>\n\t) => any = Object.defineProperty as any;\n\tconst create = Object.create;\n\n\tconst objPrototype = Object.prototype;\n\n\tconst globalSymbols: { [key: string]: symbol } = {};\n\n\tconst getSymbolName = (function() {\n\t\tconst created = create(null);\n\t\treturn function(desc: string | number): string {\n\t\t\tlet postfix = 0;\n\t\t\tlet name: string;\n\t\t\twhile (created[String(desc) + (postfix || '')]) {\n\t\t\t\t++postfix;\n\t\t\t}\n\t\t\tdesc += String(postfix || '');\n\t\t\tcreated[desc] = true;\n\t\t\tname = '@@' + desc;\n\n\t\t\t// FIXME: Temporary guard until the duplicate execution when testing can be\n\t\t\t// pinned down.\n\t\t\tif (!Object.getOwnPropertyDescriptor(objPrototype, name)) {\n\t\t\t\tdefineProperty(objPrototype, name, {\n\t\t\t\t\tset: function(this: Symbol, value: any) {\n\t\t\t\t\t\tdefineProperty(this, name, getValueDescriptor(value));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn name;\n\t\t};\n\t})();\n\n\tconst InternalSymbol = function Symbol(this: any, description?: string | number): symbol {\n\t\tif (this instanceof InternalSymbol) {\n\t\t\tthrow new TypeError('TypeError: Symbol is not a constructor');\n\t\t}\n\t\treturn Symbol(description);\n\t};\n\n\tSymbol = global.Symbol = function Symbol(this: Symbol, description?: string | number): symbol {\n\t\tif (this instanceof Symbol) {\n\t\t\tthrow new TypeError('TypeError: Symbol is not a constructor');\n\t\t}\n\t\tconst sym = Object.create(InternalSymbol.prototype);\n\t\tdescription = description === undefined ? '' : String(description);\n\t\treturn defineProperties(sym, {\n\t\t\t__description__: getValueDescriptor(description),\n\t\t\t__name__: getValueDescriptor(getSymbolName(description))\n\t\t});\n\t} as SymbolConstructor;\n\n\t/* Decorate the Symbol function with the appropriate properties */\n\tdefineProperty(\n\t\tSymbol,\n\t\t'for',\n\t\tgetValueDescriptor(function(key: string): symbol {\n\t\t\tif (globalSymbols[key]) {\n\t\t\t\treturn globalSymbols[key];\n\t\t\t}\n\t\t\treturn (globalSymbols[key] = Symbol(String(key)));\n\t\t})\n\t);\n\tdefineProperties(Symbol, {\n\t\tkeyFor: getValueDescriptor(function(sym: symbol): string | undefined {\n\t\t\tlet key: string;\n\t\t\tvalidateSymbol(sym);\n\t\t\tfor (key in globalSymbols) {\n\t\t\t\tif (globalSymbols[key] === sym) {\n\t\t\t\t\treturn key;\n\t\t\t\t}\n\t\t\t}\n\t\t}),\n\t\thasInstance: getValueDescriptor(Symbol.for('hasInstance'), false, false),\n\t\tisConcatSpreadable: getValueDescriptor(Symbol.for('isConcatSpreadable'), false, false),\n\t\titerator: getValueDescriptor(Symbol.for('iterator'), false, false),\n\t\tmatch: getValueDescriptor(Symbol.for('match'), false, false),\n\t\tobservable: getValueDescriptor(Symbol.for('observable'), false, false),\n\t\treplace: getValueDescriptor(Symbol.for('replace'), false, false),\n\t\tsearch: getValueDescriptor(Symbol.for('search'), false, false),\n\t\tspecies: getValueDescriptor(Symbol.for('species'), false, false),\n\t\tsplit: getValueDescriptor(Symbol.for('split'), false, false),\n\t\ttoPrimitive: getValueDescriptor(Symbol.for('toPrimitive'), false, false),\n\t\ttoStringTag: getValueDescriptor(Symbol.for('toStringTag'), false, false),\n\t\tunscopables: getValueDescriptor(Symbol.for('unscopables'), false, false)\n\t});\n\n\t/* Decorate the InternalSymbol object */\n\tdefineProperties(InternalSymbol.prototype, {\n\t\tconstructor: getValueDescriptor(Symbol),\n\t\ttoString: getValueDescriptor(\n\t\t\tfunction(this: { __name__: string }) {\n\t\t\t\treturn this.__name__;\n\t\t\t},\n\t\t\tfalse,\n\t\t\tfalse\n\t\t)\n\t});\n\n\t/* Decorate the Symbol.prototype */\n\tdefineProperties(Symbol.prototype, {\n\t\ttoString: getValueDescriptor(function(this: Symbol) {\n\t\t\treturn 'Symbol (' + (<any>validateSymbol(this)).__description__ + ')';\n\t\t}),\n\t\tvalueOf: getValueDescriptor(function(this: Symbol) {\n\t\t\treturn validateSymbol(this);\n\t\t})\n\t});\n\n\tdefineProperty(\n\t\tSymbol.prototype,\n\t\tSymbol.toPrimitive,\n\t\tgetValueDescriptor(function(this: Symbol) {\n\t\t\treturn validateSymbol(this);\n\t\t})\n\t);\n\tdefineProperty(Symbol.prototype, Symbol.toStringTag, getValueDescriptor('Symbol', false, false, true));\n\n\tdefineProperty(\n\t\tInternalSymbol.prototype,\n\t\tSymbol.toPrimitive,\n\t\tgetValueDescriptor((<any>Symbol).prototype[Symbol.toPrimitive], false, false, true)\n\t);\n\tdefineProperty(\n\t\tInternalSymbol.prototype,\n\t\tSymbol.toStringTag,\n\t\tgetValueDescriptor((<any>Symbol).prototype[Symbol.toStringTag], false, false, true)\n\t);\n}\n\n/**\n * A custom guard function that determines if an object is a symbol or not\n * @param  {any}       value The value to check to see if it is a symbol or not\n * @return {is symbol}       Returns true if a symbol or not (and narrows the type guard)\n */\nexport function isSymbol(value: any): value is symbol {\n\treturn (value && (typeof value === 'symbol' || value['@@toStringTag'] === 'Symbol')) || false;\n}\n\n/**\n * Fill any missing well known symbols if the native Symbol is missing them\n */\n[\n\t'hasInstance',\n\t'isConcatSpreadable',\n\t'iterator',\n\t'species',\n\t'replace',\n\t'search',\n\t'split',\n\t'match',\n\t'toPrimitive',\n\t'toStringTag',\n\t'unscopables',\n\t'observable'\n].forEach((wellKnown) => {\n\tif (!(Symbol as any)[wellKnown]) {\n\t\tObject.defineProperty(Symbol, wellKnown, getValueDescriptor(Symbol.for(wellKnown), false, false));\n\t}\n});\n\nexport default Symbol;\n"]}